id: wordpress-detect
info:
    name: WordPress Detect
    author: pdteam,daffainfo,ricardomaia,topscoder
    severity: info
    description: ""
    remediation: ""
    reference: []
    classification:
        cvssmetrics: ""
        cvssscore: 0
        cveid: ""
        cweid: ""
    metadata:
        verified: true
        shodanquery: http.component:"WordPress"
    tags: tech,wordpress,cms,wp
name: ""
requests:
    - raw: []
      cookiereuse: false
      method: GET
      path:
        - '{{BaseURL}}'
        - '{{BaseURL}}/wp-admin/install.php'
        - '{{BaseURL}}/feed/'
        - '{{BaseURL}}/?feed=rss2'
      redirects: true
      maxredirects: 2
      stopatfirstmatch: true
      matcherscondition: and
      matchers:
        - type: regex
          part: ""
          words: []
          dsl: []
          regex:
            - <generator>https?:\/\/wordpress\.org.*</generator>
            - wp-login.php
            - \/wp-content/themes\/
            - \/wp-includes\/
            - name="generator" content="wordpress
            - <link[^>]+s\d+\.wp\.com
            - <!-- This site is optimized with the Yoast (?:WordPress )?SEO plugin v([\d.]+) -
            - <!--[^>]+WP-Super-Cache
          condition: or
          status: []
        - type: status
          part: ""
          words: []
          dsl: []
          regex: []
          condition: ""
          status:
            - 200
      extractors:
        - type: regex
          name: version_by_generator
          group: 1
          regex:
            - (?m)https:\/\/wordpress.org\/\?v=([0-9.]+)
        - type: regex
          name: version_by_js
          group: 1
          regex:
            - wp-emoji-release\.min\.js\?ver=((\d+\.?)+)\b
        - type: regex
          name: version_by_css
          group: 1
          regex:
            - install\.min\.css\?ver=((\d+\.?)+)\b
workflows: []
